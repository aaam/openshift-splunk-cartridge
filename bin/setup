#!/bin/bash -eu

source $OPENSHIFT_CARTRIDGE_SDK_BASH

case "$1" in
  -v|--version)
    version="$2"
esac

# Create additional directories required by the diy cartridge
mkdir -p $OPENSHIFT_DIY_DIR/{logs,run}

mkdir -p ${OPENSHIFT_HOMEDIR}/.splunk

mkdir -p ${OPENSHIFT_DATA_DIR}/test

# Add variables to splunk-launch.conf
echo "SPLUNK_SERVER_NAME=splunkd" >> ${OPENSHIFT_DATA_DIR}/test/splunk-launch.conf
echo "SPLUNK_WEB_NAME=splunkweb" >> ${OPENSHIFT_DATA_DIR}/test/splunk-launch.conf
echo "SPLUNK_BINDIP=${EMPTY_OPENSHIFT_SPLUNK_IP}" >> ${OPENSHIFT_DATA_DIR}/test/splunk-launch.conf

client_result "Disclaimer: This is an experimental cartridge that comes provided AS IS."
